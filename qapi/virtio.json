##
# = Virtio devices
##

##
# @VirtioType:
#
# An enumeration of Virtio device types.
#
# Since: 5.1.0
##
{ 'enum': 'VirtioType',
  'data': [ 'unknown', 'virtio-9p', 'virtio-blk', 'virtio-serial',
            'virtio-gpu', 'virtio-input', 'virtio-net', 'virtio-scsi',
            'vhost-user-fs', 'vhost-vsock', 'virtio-balloon', 'virtio-crypto',
            'virtio-iommu', 'virtio-pmem', 'virtio-rng' ]
}

##
# @VirtioInfo:
#
# Information about a given VirtIODevice
#
# @path: VirtIO device canonical path.
#
# @type: VirtIO device type.
#
# Since: 5.1
#
##
{ 'struct': 'VirtioInfo',
  'data': {
    'path': 'str',
    'type': 'VirtioType'
  }
}

##
# @query-virtio:
#
# Return the list of all VirtIO devices
#
# Returns: list of @VirtioInfo
#
# Since: 5.1
#
# Example:
#
# -> { "execute": "query-virtio" }
# <- { "return": [
#        {
#            "path": "/machine/peripheral-anon/device[3]/virtio-backend",
#            "type": "virtio-net"
#        },
#        {
#            "path": "/machine/peripheral-anon/device[1]/virtio-backend",
#            "type": "virtio-serial"
#        },
#        {
#            "path": "/machine/peripheral-anon/device[0]/virtio-backend",
#            "type": "virtio-blk"
#        }
#      ]
#    }
#
##

{ 'command': 'query-virtio', 'returns': ['VirtioInfo'] }

##
# @VirtioStatusEndianness:
#
# Enumeration of endianness for VirtioDevice
#
# Since: 5.1
##
{ 'enum': 'VirtioStatusEndianness',
  'data': [ 'unknown', 'little', 'big' ]
}

##
# @VirtioStatus:
#
# @device-id: VirtIODevice status
#
# @device-endian: VirtIODevice device_endian
#
# @guest-features: VirtIODevice guest_features
#
# @host-features: VirtIODevice host_features
#
# @backend-features: VirtIODevice backend_features
#
# @num-vqs: number of VirtIODevice queues
#
# Since: 5.1
#
##

{ 'struct': 'VirtioStatus',
  'data': {
    'device-id': 'int',
    'device-endian': 'VirtioStatusEndianness',
    'guest-features': 'uint64',
    'host-features': 'uint64',
    'backend-features': 'uint64',
    'num-vqs': 'uint16'
  }
}

##
# @virtio-status:
#
# Return the status of virtio device
#
# @path: QOBject path of the VirtIODevice
#
# Returns: status of the VirtIODevice
#
# Since: 5.1
#
# Example:
#
# -> { "execute": "virtio-status",
#      "arguments": {
#          "path": "/machine/peripheral-anon/device[3]/virtio-backend"
#      }
#   }
# <- { "return": {
#          "backend-features": 0,
#          "guest-features": 5111807911,
#          "num-vqs": 3,
#          "host-features": 6337593319,
#          "device-endian": "little",
#          "device-id": 1
#      }
#    }
#
##

{ 'command': 'virtio-status',
  'data': { 'path': 'str' },
  'returns': 'VirtioStatus'
}
